<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bilder-Zaubermaschine</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 25%, #a8edea 50%, #fed6e3 75%, #d299c2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            width: 100%;
            background: white;
            border-radius: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
            text-align: center;
        }

        h1 {
            font-size: 3.5em;
            color: #ff6b6b;
            text-shadow: 3px 3px 0px #ffd93d;
            margin-bottom: 30px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .input-section {
            margin-bottom: 30px;
        }

        textarea {
            width: 100%;
            min-height: 120px;
            font-size: 1.5em;
            padding: 20px;
            border: 4px solid #4ecdc4;
            border-radius: 25px;
            resize: vertical;
            font-family: inherit;
            background: #f8f9fa;
            text-align: center;
        }

        textarea:focus {
            outline: none;
            border-color: #45b7d1;
            background: white;
            box-shadow: 0 0 20px rgba(69, 183, 209, 0.3);
        }

        .generate-btn {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
            border: none;
            font-size: 2em;
            padding: 20px 40px;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(78, 205, 196, 0.3);
            transition: all 0.3s ease;
            font-family: inherit;
            font-weight: bold;
            margin-bottom: 30px;
        }

        .generate-btn:hover:not(:disabled) {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(78, 205, 196, 0.4);
        }

        .generate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .image-container {
            display: none;
            margin: 30px 0;
        }

        .generated-image {
            max-width: 90%;
            max-height: 500px;
            width: auto;
            height: auto;
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }

        .action-buttons {
            display: none;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            font-size: 1.5em;
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            flex: 1;
            min-width: 200px;
        }

        .print-btn {
            background: linear-gradient(45deg, #ff9a56, #ff6b6b);
            color: white;
        }

        .reset-btn {
            background: linear-gradient(45deg, #a8edea, #74b9ff);
            color: #2d3436;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 25px rgba(0,0,0,0.3);
        }

        .loading, .error {
            font-size: 1.8em;
            margin: 20px 0;
            padding: 20px;
            border-radius: 20px;
            display: none;
        }

        .loading {
            background: #ffd93d;
            color: #2d3436;
        }

        .error {
            background: #ff7675;
            color: white;
        }

        @media (max-width: 768px) {
            h1 { font-size: 2.5em; }
            .generate-btn { font-size: 1.5em; padding: 15px 30px; }
            .btn { font-size: 1.2em; padding: 12px 24px; min-width: 150px; }
            .container { padding: 20px; margin: 10px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ü™Ñ Bilder-Zaubermaschine ü™Ñ</h1>
        
        <div class="input-section">
            <textarea id="promptInput" placeholder="Schreib hier, was f√ºr ein Bild du zaubern m√∂chtest! 
z.B. 'Ein blauer Drache mit Sonnenbrille auf dem Pausenhof' ‚ú®"></textarea>
            <br>
            <button class="generate-btn" id="generateBtn">üé® Bild erstellen</button>
        </div>

        <div id="loading" class="loading">‚ú® Bild wird gezaubert... bitte warte! ‚ú®</div>
        <div id="error" class="error">üò¥ Ups, der KI-Zauberstab ist gerade m√ºde. Versuch es noch einmal!</div>

        <div id="imageContainer" class="image-container">
            <img id="generatedImage" class="generated-image" alt="Generiertes Bild">
            <div class="action-buttons">
                <button class="btn print-btn" id="printBtn">üñ®Ô∏è Drucken</button>
                <button class="btn reset-btn" id="resetBtn">üîÑ Neues Bild</button>
            </div>
        </div>
    </div>

    <script>
        // =====================================================
        // HIER DEINE API-EINSTELLUNGEN EINF√úGEN:
        // =====================================================
        // 1. Hole dir einen kostenlosen API-Key von: https://huggingface.co/settings/tokens
        // 2. W√§hle ein Bildgenerierungs-Modell, z.B.:
        //    - "stabilityai/stable-diffusion-2" (gut f√ºr realistische Bilder)
        //    - "runwayml/stable-diffusion-v1-5" 
        //    - "black-forest-labs/FLUX.1-schnell" (sehr schnell, gute Qualit√§t)
        // 3. F√ºge hier deinen Key und Modellname ein:
        const HF_API_KEY = "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";  // z.B. "hf_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
        const MODEL_ID = "black-forest-labs/FLUX.1-schnell"; // z.B. "stabilityai/stable-diffusion-2"
        
        // API Basis-URL
        const API_URL = `https://api-inference.huggingface.co/models/${MODEL_ID}`;
        // =====================================================

        const promptInput = document.getElementById('promptInput');
        const generateBtn = document.getElementById('generateBtn');
        const loading = document.getElementById('loading');
        const error = document.getElementById('error');
        const imageContainer = document.getElementById('imageContainer');
        const generatedImage = document.getElementById('generatedImage');
        const printBtn = document.getElementById('printBtn');
        const resetBtn = document.getElementById('resetBtn');

        let currentImageBlob = null;

        generateBtn.addEventListener('click', async () => {
            const prompt = promptInput.value.trim();
            if (!prompt) {
                alert('‚ú® Schreib erst einen Zaubertext! ‚ú®');
                return;
            }

            if (!HF_API_KEY || HF_API_KEY === "HIER_DEIN_API_KEY_EINF√úGEN") {
                alert('üö® Bitte f√ºge zuerst deinen Hugging Face API-Key im JavaScript-Code ein!');
                return;
            }

            if (!MODEL_ID || MODEL_ID === "HIER_DEIN_MODELLNAME_EINF√úGEN") {
                alert('üö® Bitte f√ºge zuerst eine Modell-ID im JavaScript-Code ein!');
                return;
            }

            // UI-Status: Laden
            generateBtn.disabled = true;
            generateBtn.textContent = '‚è≥ Zaubern...';
            loading.style.display = 'block';
            error.style.display = 'none';
            imageContainer.style.display = 'none';

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${HF_API_KEY}`,
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        inputs: prompt,
                        parameters: {
                            num_inference_steps: 20, // Schnellere Generierung
                        }
                    }),
                });

                if (!response.ok) {
                    throw new Error(`API Fehler: ${response.status}`);
                }

                const buffer = await response.arrayBuffer();
                const blob = new Blob([buffer], { type: 'image/png' });
                currentImageBlob = blob;

                // Bild als URL erstellen und anzeigen
                const imageUrl = URL.createObjectURL(blob);
                generatedImage.src = imageUrl;
                imageContainer.style.display = 'block';

            } catch (err) {
                console.error('Generierungsfehler:', err);
                error.style.display = 'block';
            } finally {
                // UI zur√ºcksetzen
                loading.style.display = 'none';
                generateBtn.disabled = false;
                generateBtn.textContent = 'üé® Bild erstellen';
            }
        });

        // Druck-Button: Neues Fenster mit nur dem Bild
        printBtn.addEventListener('click', () => {
            if (!currentImageBlob) return;

            const printWindow = window.open('', '_blank');
            const imageUrl = URL.createObjectURL(currentImageBlob);
            
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Drucke dein Bild</title>
                    <style>
                        body { margin: 0; padding: 20px; background: white; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
                        img { max-width: 100%; max-height: 100vh; box-shadow: none; }
                    </style>
                </head>
                <body>
                    <img src="${imageUrl}" onload="window.print();">
                </body>
                </html>
            `);
            printWindow.document.close();
        });

        // Reset-Button
        resetBtn.addEventListener('click', () => {
            promptInput.value = '';
            generatedImage.src = '';
            imageContainer.style.display = 'none';
            currentImageBlob = null;
            error.style.display = 'none';
            promptInput.focus();
        });

        // Enter-Taste im Eingabefeld = Generieren
        promptInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && e.ctrlKey) {
                generateBtn.click();
            }
        });
    </script>
</body>
</html>
