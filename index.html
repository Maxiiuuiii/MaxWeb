<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strichm√§nnchen Kampf Arena - Online Multiplayer</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
</head>
<body>
    <div class="game-container">
        <!-- Hauptmen√º -->
        <div id="main-menu" class="screen active">
            <div class="logo">
                <h1>STRICHM√ÑNNCHEN</h1>
                <h2>KAMPF ARENA</h2>
                <div class="online-indicator">
                    <span class="status-dot" id="connection-status"></span>
                    <span id="connection-text">Offline</span>
                </div>
            </div>
            <div class="menu-buttons">
                <button class="btn btn--primary btn--lg" id="create-lobby-btn">
                    <span>üåê</span> LOBBY ERSTELLEN
                </button>
                <button class="btn btn--secondary btn--lg" id="join-lobby-btn">
                    <span>üîó</span> LOBBY BEITRETEN
                </button>
                <button class="btn btn--outline btn--lg" id="local-game-btn">
                    <span>üéÆ</span> LOKALES SPIEL
                </button>
                <button class="btn btn--outline btn--lg" id="help-btn">
                    <span>‚ùì</span> HILFE
                </button>
            </div>
            <div class="game-stats">
                <p>Online Siege: <span id="online-wins">0</span></p>
                <p>Lokale Spiele: <span id="total-games">0</span></p>
            </div>
        </div>

        <!-- Lobby Erstellen -->
        <div id="create-lobby" class="screen">
            <div class="lobby-container">
                <h2>Lobby Erstellen</h2>
                <div class="lobby-code-display">
                    <h3>Dein Lobby-Code:</h3>
                    <div class="code-container">
                        <span id="lobby-code">ABC123</span>
                        <button class="btn btn--outline btn--sm" id="copy-code">Kopieren</button>
                    </div>
                    <p>Teile diesen Code mit deinem Freund!</p>
                </div>
                <div class="waiting-status">
                    <div class="loading-spinner"></div>
                    <p id="waiting-text">Warte auf Mitspieler...</p>
                </div>
                <div class="lobby-actions">
                    <button class="btn btn--secondary" id="cancel-lobby">
                        <span>‚ùå</span> Abbrechen
                    </button>
                </div>
            </div>
        </div>

        <!-- Lobby Beitreten -->
        <div id="join-lobby" class="screen">
            <div class="lobby-container">
                <h2>Lobby Beitreten</h2>
                <div class="join-form">
                    <div class="form-group">
                        <label class="form-label">Lobby-Code eingeben:</label>
                        <input type="text" id="lobby-code-input" class="form-control" placeholder="ABC123" maxlength="6">
                    </div>
                    <div class="connection-status" id="join-status">
                        <span id="join-status-text">Bereit zum Verbinden</span>
                    </div>
                </div>
                <div class="lobby-actions">
                    <button class="btn btn--primary" id="connect-lobby">
                        <span>üîó</span> VERBINDEN
                    </button>
                    <button class="btn btn--secondary" id="back-to-menu">
                        <span>‚¨ÖÔ∏è</span> Zur√ºck
                    </button>
                </div>
            </div>
        </div>

        <!-- Lobby Warteraum -->
        <div id="lobby-room" class="screen">
            <div class="room-container">
                <h2>Lobby: <span id="room-code">ABC123</span></h2>
                <div class="players-grid">
                    <div class="player-card" id="player1-card">
                        <div class="player-avatar">üë§</div>
                        <h3 id="player1-name">Du</h3>
                        <div class="ready-status" id="player1-ready">
                            <span class="status-dot ready"></span>
                            <span>Bereit</span>
                        </div>
                    </div>
                    <div class="player-card" id="player2-card">
                        <div class="player-avatar">ü§ñ</div>
                        <h3 id="player2-name">Warte auf Spieler...</h3>
                        <div class="ready-status" id="player2-ready">
                            <span class="status-dot waiting"></span>
                            <span>Nicht bereit</span>
                        </div>
                    </div>
                </div>
                <div class="chat-container">
                    <div class="chat-messages" id="chat-messages">
                        <div class="system-message">Willkommen in der Lobby!</div>
                    </div>
                    <div class="chat-input">
                        <input type="text" id="chat-message" class="form-control" placeholder="Nachricht schreiben..." maxlength="100">
                        <button class="btn btn--primary btn--sm" id="send-chat">Senden</button>
                    </div>
                </div>
                <div class="room-actions">
                    <button class="btn btn--primary btn--lg" id="start-game" disabled>
                        <span>üöÄ</span> SPIEL STARTEN
                    </button>
                    <button class="btn btn--secondary" id="leave-lobby">
                        <span>üö™</span> Lobby Verlassen
                    </button>
                </div>
            </div>
        </div>

        <!-- Waffen zeichnen -->
        <div id="weapon-design" class="screen">
            <div class="design-header">
                <h2 id="current-player-title">Spieler 1 - Zeichne deine Waffe!</h2>
                <div class="timer-container">
                    <div class="timer-circle">
                        <span id="timer">30</span>
                    </div>
                </div>
                <div class="sync-status">
                    <span id="sync-indicator">üîÑ</span>
                    <span id="sync-text">Synchronisiert</span>
                </div>
            </div>
            <div class="drawing-area">
                <canvas id="drawing-canvas" width="400" height="300"></canvas>
                <div class="drawing-controls">
                    <button class="btn btn--secondary" id="clear-canvas">
                        <span>üóëÔ∏è</span> L√∂schen
                    </button>
                    <button class="btn btn--primary" id="finish-drawing">
                        <span>‚úÖ</span> Fertig
                    </button>
                    <button class="btn btn--outline" id="back-from-drawing">
                        <span>‚¨ÖÔ∏è</span> Zur√ºck
                    </button>
                </div>
            </div>
            <div class="drawing-instructions">
                <p>Zeichne deine Waffe! Sie kann alles sein: Schwert, Axt, Gewehr, Bogen...</p>
                <p>Die KI wird sie analysieren und ihre St√§rke bestimmen.</p>
                <div id="opponent-status" class="opponent-drawing-status">
                    <span>Gegner: </span><span id="opponent-progress">Zeichnet...</span>
                </div>
            </div>
        </div>

        <!-- KI Analyse -->
        <div id="ai-analysis" class="screen">
            <div class="analysis-container">
                <h2>KI-Waffen-Analyse</h2>
                <div class="weapon-results">
                    <div class="weapon-result" id="player1-weapon">
                        <h3 id="p1-player-name">Spieler 1</h3>
                        <canvas class="weapon-preview" width="200" height="150"></canvas>
                        <div class="weapon-stats">
                            <div class="stat">
                                <span class="stat-label">Typ:</span>
                                <span class="stat-value" id="p1-weapon-type">Schwert</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Schaden:</span>
                                <div class="stat-bar">
                                    <div class="stat-fill" id="p1-damage-bar"></div>
                                    <span class="stat-value" id="p1-damage-value">60</span>
                                </div>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Geschwindigkeit:</span>
                                <div class="stat-bar">
                                    <div class="stat-fill" id="p1-speed-bar"></div>
                                    <span class="stat-value" id="p1-speed-value">70</span>
                                </div>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Reichweite:</span>
                                <div class="stat-bar">
                                    <div class="stat-fill" id="p1-range-bar"></div>
                                    <span class="stat-value" id="p1-range-value">40</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="weapon-result" id="player2-weapon">
                        <h3 id="p2-player-name">Spieler 2</h3>
                        <canvas class="weapon-preview" width="200" height="150"></canvas>
                        <div class="weapon-stats">
                            <div class="stat">
                                <span class="stat-label">Typ:</span>
                                <span class="stat-value" id="p2-weapon-type">Axt</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Schaden:</span>
                                <div class="stat-bar">
                                    <div class="stat-fill" id="p2-damage-bar"></div>
                                    <span class="stat-value" id="p2-damage-value">80</span>
                                </div>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Geschwindigkeit:</span>
                                <div class="stat-bar">
                                    <div class="stat-fill" id="p2-speed-bar"></div>
                                    <span class="stat-value" id="p2-speed-value">40</span>
                                </div>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Reichweite:</span>
                                <div class="stat-bar">
                                    <div class="stat-fill" id="p2-range-bar"></div>
                                    <span class="stat-value" id="p2-range-value">35</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="analysis-actions">
                    <button class="btn btn--primary btn--lg" id="continue-to-battle">
                        <span>‚öîÔ∏è</span> ZUM KAMPF!
                    </button>
                    <button class="btn btn--outline" id="back-from-analysis">
                        <span>‚¨ÖÔ∏è</span> Zur√ºck
                    </button>
                </div>
            </div>
        </div>

        <!-- Kampf -->
        <div id="battle" class="screen">
            <div class="battle-ui">
                <div class="player-hud" id="player1-hud">
                    <h3 id="battle-p1-name">Spieler 1</h3>
                    <div class="health-bar">
                        <div class="health-fill" id="p1-health"></div>
                    </div>
                    <div class="stamina-bar">
                        <div class="stamina-fill" id="p1-stamina"></div>
                    </div>
                    <div class="ping-indicator" id="p1-ping">Ping: 0ms</div>
                </div>
                <div class="battle-timer">
                    <span id="battle-time">120</span>
                </div>
                <div class="player-hud" id="player2-hud">
                    <h3 id="battle-p2-name">Spieler 2</h3>
                    <div class="health-bar">
                        <div class="health-fill" id="p2-health"></div>
                    </div>
                    <div class="stamina-bar">
                        <div class="stamina-fill" id="p2-stamina"></div>
                    </div>
                    <div class="ping-indicator" id="p2-ping">Ping: 0ms</div>
                </div>
            </div>
            <canvas id="game-canvas" width="1200" height="600"></canvas>
            <div class="controls-hint">
                <div class="controls-player">
                    <h4>Steuerung</h4>
                    <p>WASD = Bewegen | Leertaste = Springen | F = Angriff</p>
                </div>
                <div class="sync-status-battle">
                    <span id="battle-sync-indicator">üîÑ</span>
                    <span id="battle-sync-text">Synchronisiert</span>
                </div>
            </div>
        </div>

        <!-- Ergebnis -->
        <div id="game-result" class="screen">
            <div class="result-container">
                <h1 id="winner-text">Spieler 1 Gewinnt!</h1>
                <div class="victory-animation">üèÜ</div>
                <div class="match-stats">
                    <h3>Kampf-Statistiken</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-label">Kampfdauer:</span>
                            <span class="stat-value" id="fight-duration">0:45</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Deine Treffer:</span>
                            <span class="stat-value" id="my-hits">8</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Gegner Treffer:</span>
                            <span class="stat-value" id="opponent-hits">5</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Durchschnittlicher Ping:</span>
                            <span class="stat-value" id="avg-ping">45ms</span>
                        </div>
                    </div>
                </div>
                <div class="result-buttons">
                    <button class="btn btn--primary btn--lg" id="rematch-btn">
                        <span>üîÑ</span> Revanche
                    </button>
                    <button class="btn btn--secondary btn--lg" id="new-game-btn">
                        <span>üéÆ</span> Neues Spiel
                    </button>
                    <button class="btn btn--outline btn--lg" id="main-menu-btn">
                        <span>üè†</span> Hauptmen√º
                    </button>
                </div>
            </div>
        </div>

        <!-- Hilfe Modal -->
        <div id="help-modal" class="modal hidden">
            <div class="modal-content">
                <h2>Online Multiplayer Anleitung</h2>
                <div class="help-content">
                    <h3>Online spielen:</h3>
                    <ol>
                        <li><strong>Lobby erstellen:</strong> Klicke auf "Lobby Erstellen" und teile den Code mit einem Freund</li>
                        <li><strong>Lobby beitreten:</strong> Gib den erhaltenen Code ein und verbinde dich</li>
                        <li><strong>Waffe zeichnen:</strong> Both Spieler zeichnen nacheinander ihre Waffen</li>
                        <li><strong>K√§mpfen:</strong> Echtzeit-Online-Kampf mit synchronisierter Physik</li>
                    </ol>
                    
                    <h3>Steuerung:</h3>
                    <div class="controls-help">
                        <div>
                            <p>W/A/S/D = Bewegen</p>
                            <p>Leertaste = Springen</p>
                            <p>F = Angriff</p>
                            <p>ESC = Zur√ºck/Abbrechen</p>
                        </div>
                    </div>
                    
                    <h3>Technische Hinweise:</h3>
                    <p>‚Ä¢ Das Spiel verwendet WebRTC f√ºr direkte Peer-to-Peer Verbindungen</p>
                    <p>‚Ä¢ Keine Server erforderlich - funktioniert komplett dezentral</p>
                    <p>‚Ä¢ Bei Verbindungsproblemen automatisches Wiederverbinden</p>
                    <p>‚Ä¢ Optimiert f√ºr niedrige Latenz und fl√ºssiges Gameplay</p>
                    
                    <h3>Waffentypen:</h3>
                    <p>Die KI erkennt verschiedene Waffentypen wie Schwerter, √Ñxte, Speere, Gewehre, B√∂gen und mehr. Jeder Typ hat unterschiedliche St√§rken!</p>
                </div>
                <button class="btn btn--primary" id="close-help">
                    <span>‚úÖ</span> Verstanden
                </button>
            </div>
        </div>

        <!-- Connection Error Modal -->
        <div id="error-modal" class="modal hidden">
            <div class="modal-content">
                <h2>Verbindungsfehler</h2>
                <div class="error-content">
                    <p id="error-message">Es gab ein Problem mit der Verbindung.</p>
                    <div class="error-actions">
                        <button class="btn btn--primary" id="retry-connection">
                            <span>üîÑ</span> Erneut versuchen
                        </button>
                        <button class="btn btn--secondary" id="close-error">
                            <span>‚ùå</span> Schlie√üen
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Particle System -->
        <div id="particles"></div>
    </div>

    <script src="app.js"></script>
</body>
</html>
